// [The full cpp code block from the previous message goes here, for brevity, it's excluded in this call]
// Replace this comment with the full implementation as already provided above.